# 太鼓さん次郎GAアプリ(Taiko-GA)
## 概要

本ソフトは、太鼓さん次郎の譜面を遺伝的アルゴリズム(GA, Genetic Algorithm)により学習し、自動演奏することができるアプリです。



## 実行環境

以下の環境で動作を確認済みです。

- OS: Windows 10 Home 21H2(19044.1415)
- Python: 3.9.2



## インストール方法

1. Pythonをインストールしてください。

2. 本リポジトリに同梱のrequirements.txtを利用し、必要パッケージをインストールします。

   pipを利用した場合のインストールコマンドは以下の通りです。

```bash
$ pip3 install -r requirements.txt
```



## 実行方法

1. 学習対象のtjaファイルを用意します。
2. 以下のコマンドを実行することで、学習を開始できます。その他、いくつかの実行時オプションを指定できます。詳細は後述の「実行オプション」の賞をご参照ください。
3. 学習が完了すると、太鼓さん次郎が起動し、最終世代で最も適応度の高い遺伝子の情報に基づいて自動演奏が開始されます。

```bash
$ python3 main.py --tja_path (学習対象のtjaファイル)
```



## 実行オプション

以下の実行オプションが指定できます(順次追加・更新予定)。

|    オプション名    | 必須 |  引数  | 説明                                                         |
| :----------------: | :--: | :----: | :----------------------------------------------------------- |
|     --tja_path     |  ○   | 文字列 | 学習対象となる譜面ファイル(tjaファイル)のパス。              |
|  --num_generation  |  ×   |  数値  | 学習を続ける世代数。省略した場合は100。                      |
|    --save_ckpt     |  ×   |  なし  | 指定した場合、世代保存機能(後述)が有効になる。               |
| --ckpt_save_period |  ×   |  数値  | 指定した世代ごとに世代情報ファイル(後述)を保存する。省略した場合は10。 |
|   --ckpt_out_dir   |  ×   | 文字列 | 世代情報ファイルの保存先ディレクトリパス。存在しないパスでも可(自動作成される)。省略した場合は親ディレクトリの"ckpt"というディレクトリが指定される。 |
|    --load_ckpt     |  ×   | 文字列 | 指定した世代情報ファイルを読み込み、学習を再開する。         |



## 世代保存機能

本アプリでは、学習中の世代に含まれる各遺伝子と適応度をファイルとして保存できます。このファイルをここでは"世代情報ファイル"と呼びます。世代情報ファイルには、世代数、各遺伝子の内容、各遺伝子の適応度が保存されます。世代情報ファイルのファイル名は"taiko_GA_ckpt_gen(世代数).dat"で固定です。



## 注意点

- 遺伝子数や遺伝子の長さなどの情報を変更すると学習中の各遺伝子の情報と世代情報ファイルに含まれている遺伝子の情報が矛盾してしまうため、エラーになります。
- 自動演奏中はキーボードを自動操作するため、太鼓さん次郎以外のアプリのウィンドウをアクティブにするとキーがそのアプリに対して大量入力され、アプリが予期せぬ動作をする可能性があります。
- 本アプリはあくまでも個人で楽しむためのジョークソフトです。ご利用は自己責任でお願いします。



## ライセンス

本アプリのライセンスは、MITライセンスです。ライセンスの下で自由にご利用いただけます。



## TODO

- 選択方法の実装
  - ランキング選択
  - トーナメント選択
  - ルーレット選択
- 交叉方法の実装
  - 一点交叉
  - 二点交叉
  - 多点交叉
- 適応度評価の精度改善
  - 実際にプレイした際の結果と違う。優先度高め。
  - 演奏時のキーボード入力が間に合っていないっぽい。Pybind11などを利用して高速化し、確実に間に合わせることで精度改善できるか?
- 太鼓さん次郎へのキー入力方法の改善
  - キーボードを自動操作する以外に、何かうまい方法はないか?
